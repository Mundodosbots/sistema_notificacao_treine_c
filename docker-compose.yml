version: '3.8'

services:
  nextfit-scheduler:
    build: .
    container_name: nextfit-scheduler
    restart: unless-stopped
    env_file:
      - .env  # Carregar vari√°veis do arquivo .env
    environment:
      - TZ=America/Sao_Paulo
      - DATA_DIR=/app/data
      - LOG_DIR=/app/logs
      - NEXTFIT_API_KEY=N5dTS6i7mSu9pQ4PUeN_zuvIDiT4qmGv
      # API de Mensagens (mundodosbots)
      - MESSAGE_API_TOKEN=${MESSAGE_API_TOKEN:-}
      # Flow IDs para cada tipo de mensagem
      - FLOW_ID_VENCENDO_HOJE=${FLOW_ID_VENCENDO_HOJE:-0}
      - FLOW_ID_VENCENDO_3_DIAS=${FLOW_ID_VENCENDO_3_DIAS:-0}
      - FLOW_ID_VENCIDO_3_DIAS=${FLOW_ID_VENCIDO_3_DIAS:-0}
      - FLOW_ID_VENCIDO_5_DIAS=${FLOW_ID_VENCIDO_5_DIAS:-0}
      - FLOW_ID_VENCIDO_30_DIAS=${FLOW_ID_VENCIDO_30_DIAS:-0}
      - FLOW_ID_ANIVERSARIANTE=${FLOW_ID_ANIVERSARIANTE:-0}
      # Nomes dos campos customizados na API de mensagens
      - MESSAGE_FIELD_1=${MESSAGE_FIELD_1:-}
      - MESSAGE_FIELD_2=${MESSAGE_FIELD_2:-}
      - MESSAGE_FIELD_3=${MESSAGE_FIELD_3:-}
      - MESSAGE_FIELD_4=${MESSAGE_FIELD_4:-}
    volumes:
      # Volume persistente para dados JSON
      - ./data:/app/data
      # Volume para logs (opcional)
      - ./logs:/app/logs
    networks:
      - nextfit-network
    # Manter container rodando
    stdin_open: true
    tty: true

networks:
  nextfit-network:
    driver: bridge
